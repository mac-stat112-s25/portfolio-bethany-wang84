{
  "hash": "2288c09ad5c5cdd374eb06d5a6cfe2d4",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Mulivariate Viz\"\n---\n\n::: {.cell}\n\n```{.r .cell-code}\n# Import and check out data\neducation <- read.csv(\"https://mac-stat.github.io/data/sat.csv\")\nhead(education)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n       State expend ratio salary frac verbal math  sat  fracCat\n1    Alabama  4.405  17.2 31.144    8    491  538 1029   (0,15]\n2     Alaska  8.963  17.6 47.951   47    445  489  934 (45,100]\n3    Arizona  4.778  19.3 32.175   27    448  496  944  (15,45]\n4   Arkansas  4.459  17.1 28.934    6    482  523 1005   (0,15]\n5 California  4.992  24.0 41.078   45    417  485  902  (15,45]\n6   Colorado  5.443  18.4 34.571   29    462  518  980  (15,45]\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.1     ✔ tibble    3.2.1\n✔ lubridate 1.9.3     ✔ tidyr     1.3.1\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n\n\n:::\n\n```{.r .cell-code}\n# Exercise 1a: Plot average SAT scores by state\nggplot(education, aes(x = reorder(State, sat), y = sat)) +\n  geom_col(fill = \"steelblue\") +\n  coord_flip() +\n  labs(x = \"State\", y = \"Average SAT\")\n```\n\n::: {.cell-output-display}\n![](ica-multi_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# • Range: ~900 to ~1100\n# • Typical: most states around ~1000\n# • Shape: a few high‐scoring outliers, slight skew\n# • Non‐normal: extreme values (e.g. small states or selective testers)\n\n# Exercise 2a: SAT vs per‐pupil spending\nggplot(education, aes(x = expend, y = sat)) +\n  geom_point() +\n  geom_smooth(method = \"lm\", se = FALSE) +\n  labs(x = \"Expenditure per Pupil (thousands $)\", y = \"Average SAT\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](ica-multi_files/figure-html/unnamed-chunk-2-2.png){width=672}\n:::\n\n```{.r .cell-code}\n# Trend: slight negative slope—higher spending ↔ lower SAT overall\n\n# Exercise 2a: SAT vs teacher salary\nggplot(education, aes(x = salary, y = sat)) +\n  geom_point() +\n  geom_smooth(method = \"lm\", se = FALSE) +\n  labs(x = \"Average Teacher Salary (thousands $)\", y = \"Average SAT\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](ica-multi_files/figure-html/unnamed-chunk-2-3.png){width=672}\n:::\n\n```{.r .cell-code}\n# Trend: flat-to-slight negative—no clear positive link between salary and SAT\n\n# Exercise 3: Trivariate viz (sat ~ expend colored by salary)\nggplot(education, aes(x = expend, y = sat, color = salary)) +\n  geom_point(size = 3) +\n  geom_smooth(method = \"lm\", se = FALSE) +\n  labs(color = \"Salary (k$)\", x = \"Spending (k$)\", y = \"Average SAT\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: The following aesthetics were dropped during statistical transformation:\ncolour.\nℹ This can happen when ggplot fails to infer the correct grouping structure in\n  the data.\nℹ Did you forget to specify a `group` aesthetic or to convert a numerical\n  variable into a factor?\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](ica-multi_files/figure-html/unnamed-chunk-2-4.png){width=672}\n:::\n\n```{.r .cell-code}\n# • Color gradient shows salary levels\n# • Both higher spending and higher salary states tend to cluster differently,\n#   but overall relationships remain weak/negative\n\n# Exercise 4: Discretize spending into 2 groups\nggplot(education, aes(x = salary, y = sat, color = cut(expend, 2))) +\n  geom_point() +\n  geom_smooth(method = \"lm\", se = FALSE) +\n  labs(color = \"Spending Group\", x = \"Salary (k$)\", y = \"Average SAT\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](ica-multi_files/figure-html/unnamed-chunk-2-5.png){width=672}\n:::\n\n```{.r .cell-code}\n# • cut(...,2) splits into low/high spending\n# • If cut(...,3), you get low/medium/high—more nuance\n# • Within each spending group, SAT and salary trend positive or flat\n\n# Exercise 5a: Univariate viz of fracCat\nggplot(education, aes(x = fracCat)) +\n  geom_bar(fill = \"lightgreen\") +\n  labs(x = \"SAT Participation Category\", y = \"Number of States\")\n```\n\n::: {.cell-output-display}\n![](ica-multi_files/figure-html/unnamed-chunk-2-6.png){width=672}\n:::\n\n```{.r .cell-code}\n# • Shows counts: most states medium (15–45%), fewer low (<15%) or high (>45%)\n\n# Exercise 5b: SAT vs fracCat (boxplot & violin)\nggplot(education, aes(x = fracCat, y = sat)) +\n  geom_boxplot(fill = \"orange\") +\n  labs(x = \"Participation Category\", y = \"Average SAT\")\n```\n\n::: {.cell-output-display}\n![](ica-multi_files/figure-html/unnamed-chunk-2-7.png){width=672}\n:::\n\n```{.r .cell-code}\n# • Low participation → highest median SAT\n# • High participation → lowest median SAT\n\nggplot(education, aes(x = fracCat, y = sat)) +\n  geom_violin(trim = FALSE, fill = \"purple\", alpha = 0.6) +\n  labs(x = \"Participation Category\", y = \"Average SAT\")\n```\n\n::: {.cell-output-display}\n![](ica-multi_files/figure-html/unnamed-chunk-2-8.png){width=672}\n:::\n\n```{.r .cell-code}\n# • Violin confirms boxplot pattern and shows full distribution shape\n\n# Exercise 5c: Trivariate viz (sat ~ expend colored by fracCat)\nggplot(education, aes(x = expend, y = sat, color = fracCat)) +\n  geom_point(size = 3) +\n  geom_smooth(method = \"lm\", se = FALSE) +\n  labs(color = \"Participation\", x = \"Spending (k$)\", y = \"Average SAT\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](ica-multi_files/figure-html/unnamed-chunk-2-9.png){width=672}\n:::\n\n```{.r .cell-code}\n# • Within each fracCat group, spending and SAT correlate positively\n# • Overall negative trend is due to mixing groups with different fracCat\n\n# Exercise 5d: Simpson’s Paradox explanation\n# • Low‐participation states (small test‐taker fraction) have high SAT but low spending.\n# • High‐participation states have lower SAT but higher spending.\n# • Aggregating creates a misleading negative overall correlation,\n#   whereas controlling for fracCat reveals the true within‐group positive relationships.\n```\n:::\n\n\n\n\n\nUse this file for practice with the **mulivariate viz** in-class activity.  Refer to the class website for details.\n",
    "supporting": [
      "ica-multi_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}