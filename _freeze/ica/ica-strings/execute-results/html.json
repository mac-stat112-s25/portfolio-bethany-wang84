{
  "hash": "7413988d3d36220d92c345859d87014f",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Strings\"\n---\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load required packages\nlibrary(tidyverse)  \n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.1     ✔ tibble    3.2.1\n✔ lubridate 1.9.3     ✔ tidyr     1.3.1\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(mosaic)    \n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRegistered S3 method overwritten by 'mosaic':\n  method                           from   \n  fortify.SpatialPolygonsDataFrame ggplot2\n\nThe 'mosaic' package masks several functions from core packages in order to add \nadditional features.  The original behavior of these functions should not be affected by this.\n\nAttaching package: 'mosaic'\n\nThe following object is masked from 'package:Matrix':\n\n    mean\n\nThe following objects are masked from 'package:dplyr':\n\n    count, do, tally\n\nThe following object is masked from 'package:purrr':\n\n    cross\n\nThe following object is masked from 'package:ggplot2':\n\n    stat\n\nThe following objects are masked from 'package:stats':\n\n    binom.test, cor, cor.test, cov, fivenum, IQR, median, prop.test,\n    quantile, sd, t.test, var\n\nThe following objects are masked from 'package:base':\n\n    max, mean, min, prod, range, sample, sum\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(rnaturalearth) \nlibrary(sf)          \n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLinking to GEOS 3.13.0, GDAL 3.8.5, PROJ 9.5.1; sf_use_s2() is TRUE\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(maps)    \n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'maps'\n\nThe following object is masked from 'package:purrr':\n\n    map\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(RColorBrewer) \nlibrary(leaflet)    \nlibrary(fivethirtyeight)  \ncourses <- read.csv(\"https://mac-stat.github.io/data/registrar.csv\")\n# Check it out\nhead(courses)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n       number   crn                                                name  days\n1 AMST 112-01 10318         Introduction to African American Literature M W F\n2 AMST 194-01 10073              Introduction to Asian American Studies M W F\n3 AMST 194-F1 10072 What’s After White Empire - And Is It Already Here?  T R \n4 AMST 203-01 10646 Politics and Inequality: The American Welfare State M W F\n5 AMST 205-01 10842                         Trans Theories and Politics  T R \n6 AMST 209-01 10474                   Civil Rights in the United States   W  \n             time      room             instructor avail_max\n1 9:40 - 10:40 am  MAIN 009       Daylanne English    3 / 20\n2  1:10 - 2:10 pm MUSIC 219          Jake Nagasawa   -4 / 16\n3  3:00 - 4:30 pm   HUM 214 Karin Aguilar-San Juan    0 / 14\n4 9:40 - 10:40 am  CARN 305          Lesley Lavery    3 / 25\n5  3:00 - 4:30 pm  MAIN 009              Myrl Beam   -2 / 20\n6 7:00 - 10:00 pm  MAIN 010         Walter Greason   -1 / 15\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Exercise 1: Time slots\n# Count how many classes meet in each days × time slot, then show the top 6\ncourses %>%\n  count(days, time, sort = TRUE) %>%\n  head(6)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   days             time  n\n1 M W F 10:50 - 11:50 am 76\n2  T R   9:40 - 11:10 am 71\n3 M W F  9:40 - 10:40 am 68\n4 M W F   1:10 - 2:10 pm 66\n5  T R    3:00 - 4:30 pm 62\n6  T R    1:20 - 2:50 pm 59\n```\n\n\n:::\n\n```{.r .cell-code}\n# • ‘count(days, time)’ tallies each unique combination of meeting days and time\n# • ‘sort = TRUE’ orders by descending frequency\n\n# Exercise 2: Prep the data\ncourses_clean <- courses %>%\n  # split \"avail_max\" into two numeric columns\n  separate(avail_max, into = c(\"avail\", \"max\"), sep = \" / \") %>%\n  mutate(across(c(avail, max), as.numeric),\n         enroll = max - avail) %>%        # compute actual enrollment\n  # split \"number\" like \"AMST 112-01\" into dept, course number, section\n  separate(number,\n           into = c(\"dept\", \"number\", \"section\"),\n           sep = \"[- ]\",\n           extra = \"merge\") %>%\n  relocate(dept, number, section, .before = name)\nhead(courses_clean)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n    crn dept number section                                                name\n1 10318 AMST    112      01         Introduction to African American Literature\n2 10073 AMST    194      01              Introduction to Asian American Studies\n3 10072 AMST    194      F1 What’s After White Empire - And Is It Already Here?\n4 10646 AMST    203      01 Politics and Inequality: The American Welfare State\n5 10842 AMST    205      01                         Trans Theories and Politics\n6 10474 AMST    209      01                   Civil Rights in the United States\n   days            time      room             instructor avail max enroll\n1 M W F 9:40 - 10:40 am  MAIN 009       Daylanne English     3  20     17\n2 M W F  1:10 - 2:10 pm MUSIC 219          Jake Nagasawa    -4  16     20\n3  T R   3:00 - 4:30 pm   HUM 214 Karin Aguilar-San Juan     0  14     14\n4 M W F 9:40 - 10:40 am  CARN 305          Lesley Lavery     3  25     22\n5  T R   3:00 - 4:30 pm  MAIN 009              Myrl Beam    -2  20     22\n6   W   7:00 - 10:00 pm  MAIN 010         Walter Greason    -1  15     16\n```\n\n\n:::\n\n```{.r .cell-code}\n# • courses_clean now has: dept, number, section, name, days, time, room, instructor, avail, max, enroll\n\n# Exercise 3: Courses by department\n# a) 6 depts offering the most sections\ncourses_clean %>%\n  count(dept, sort = TRUE) %>%\n  head(6)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  dept  n\n1 SPAN 45\n2 BIOL 44\n3 ENVI 38\n4 PSYC 37\n5 CHEM 33\n6 COMP 31\n```\n\n\n:::\n\n```{.r .cell-code}\n# b) 6 depts with longest average course titles\ncourses_clean %>%\n  mutate(title_length = nchar(name)) %>%\n  group_by(dept) %>%\n  summarize(avg_title_length = mean(title_length), .groups = \"drop\") %>%\n  arrange(desc(avg_title_length)) %>%\n  head(6)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 2\n  dept  avg_title_length\n  <chr>            <dbl>\n1 WGSS              46.3\n2 INTL              41.4\n3 EDUC              39.4\n4 MCST              39.4\n5 POLI              37.4\n6 AMST              37.3\n```\n\n\n:::\n\n```{.r .cell-code}\n# Exercise 4: STAT courses\n# a) Courses taught by Alicia Johnson\ncourses_clean %>%\n  filter(instructor == \"Alicia Johnson\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n    crn dept number section                         name  days            time\n1 10806 STAT    253      01 Statistical Machine Learning  T R  9:40 - 11:10 am\n2 10807 STAT    253      02 Statistical Machine Learning  T R   1:20 - 2:50 pm\n3 10808 STAT    253      03 Statistical Machine Learning  T R   3:00 - 4:30 pm\n        room     instructor avail max enroll\n1 THEATR 206 Alicia Johnson    -3  20     23\n2 THEATR 206 Alicia Johnson    -3  20     23\n3 THEATR 206 Alicia Johnson     2  20     18\n```\n\n\n:::\n\n```{.r .cell-code}\n# b) STAT sections: clean up names, extract start time\nstat <- courses_clean %>%\n  filter(dept == \"STAT\") %>%\n  mutate(\n    name      = str_remove(name, \"^Introduction to \"),\n    name      = str_replace(name, \"Statistical\", \"Stat\"),\n    start_time = str_trim(str_extract(time, \"^[^\\\\-]+\"))\n  ) %>%\n  select(number, name, start_time, enroll)\nnrow(stat)  # should be 19\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 19\n```\n\n\n:::\n\n```{.r .cell-code}\nhead(stat)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  number          name start_time enroll\n1    112  Data Science       3:00     27\n2    112  Data Science       9:40     21\n3    112  Data Science       1:20     25\n4    125  Epidemiology      12:00     26\n5    155 Stat Modeling       1:10     32\n6    155 Stat Modeling       9:40     24\n```\n\n\n:::\n\n```{.r .cell-code}\n# Exercise 5: More cleaning for enrollments\nenrollments <- courses_clean %>%\n  filter(!dept %in% c(\"PE\", \"INTD\")) %>%                             # drop PE and INTD\n  filter(!(dept == \"MUSI\" & as.numeric(number) < 100),\n         !(dept == \"THDA\" & as.numeric(number) < 100)) %>%           # drop ensembles/practicums\n  filter(!str_detect(name, \"\\\\bLab\\\\b\"))                             # drop true lab sections\nhead(enrollments)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n    crn dept number section                                                name\n1 10318 AMST    112      01         Introduction to African American Literature\n2 10073 AMST    194      01              Introduction to Asian American Studies\n3 10072 AMST    194      F1 What’s After White Empire - And Is It Already Here?\n4 10646 AMST    203      01 Politics and Inequality: The American Welfare State\n5 10842 AMST    205      01                         Trans Theories and Politics\n6 10474 AMST    209      01                   Civil Rights in the United States\n   days            time      room             instructor avail max enroll\n1 M W F 9:40 - 10:40 am  MAIN 009       Daylanne English     3  20     17\n2 M W F  1:10 - 2:10 pm MUSIC 219          Jake Nagasawa    -4  16     20\n3  T R   3:00 - 4:30 pm   HUM 214 Karin Aguilar-San Juan     0  14     14\n4 M W F 9:40 - 10:40 am  CARN 305          Lesley Lavery     3  25     22\n5  T R   3:00 - 4:30 pm  MAIN 009              Myrl Beam    -2  20     22\n6   W   7:00 - 10:00 pm  MAIN 010         Walter Greason    -1  15     16\n```\n\n\n:::\n\n```{.r .cell-code}\n# Exercise 6: Enrollment & departments\n# Example explorations:\n\n# Numerical summary: median and count of enrollments by department\nenrollments %>%\n  group_by(dept) %>%\n  summarize(\n    median_enroll = median(enroll),\n    section_count = n(),\n    .groups = \"drop\"\n  ) %>%\n  arrange(desc(section_count))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 38 × 3\n   dept  median_enroll section_count\n   <chr>         <dbl>         <int>\n 1 ENGL           15.5            30\n 2 COMP           17              28\n 3 ENVI           18              28\n 4 ECON           20              27\n 5 POLI           18              27\n 6 PSYC           21              27\n 7 SPAN           15              26\n 8 BIOL           16              23\n 9 AMST           15              22\n10 HIST           15.5            22\n# ℹ 28 more rows\n```\n\n\n:::\n\n```{.r .cell-code}\n# Visualization: distribution of section sizes by department\nggplot(enrollments, aes(x = enroll)) +\n  geom_histogram(binwidth = 5) +\n  facet_wrap(~ dept, scales = \"free_y\") +\n  labs(\n    x = \"Enrollment per Section\",\n    y = \"Number of Sections\",\n    title = \"Section Size Distributions by Department\"\n  )\n```\n\n::: {.cell-output-display}\n![](ica-strings_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "ica-strings_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}